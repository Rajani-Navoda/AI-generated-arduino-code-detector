/* --------------------------------------------------------------
  Example sketch of sine generator. 

  Author: Christoph Jurczyk
 -------------------------------------------------------------- */

#include <AD7390.h>

// Pins
#define DAC_CS 8

// DAC init
AD7390 dac(DAC_CS);

// Variables
uint16_t output_signal = 0;
uint16_t index = 0;

// Sine table
const uint16_t sine_table[500] = {2048,2073,2099,2125,2151,2176,2202,2228,2253,2279,2305,2330,2356,2381,
2407,2432,2457,2482,2508,2533,2558,2583,2607,2632,2657,2681,2706,2730,
2755,2779,2803,2827,2850,2874,2898,2921,2944,2967,2990,3013,3036,3058,
3081,3103,3125,3147,3168,3190,3211,3232,3253,3274,3294,3315,3335,3355,
3375,3394,3413,3432,3451,3470,3488,3507,3525,3542,3560,3577,3594,3611,
3627,3644,3660,3675,3691,3706,3721,3736,3750,3765,3778,3792,3805,3819,
3831,3844,3856,3868,3880,3891,3902,3913,3923,3934,3943,3953,3962,3971,
3980,3988,3996,4004,4012,4019,4026,4032,4038,4044,4050,4055,4060,4064,
4069,4073,4076,4080,4083,4085,4088,4090,4091,4093,4094,4095,4095,4095,
4095,4094,4093,4092,4091,4089,4086,4084,4081,4078,4074,4071,4067,4062,
4057,4052,4047,4041,4035,4029,4022,4015,4008,4000,3992,3984,3976,3967,
3958,3948,3939,3928,3918,3908,3897,3885,3874,3862,3850,3838,3825,3812,
3799,3785,3772,3758,3743,3729,3714,3699,3683,3668,3652,3636,3619,3603,
3586,3569,3551,3534,3516,3498,3479,3461,3442,3423,3404,3384,3365,3345,
3325,3305,3284,3263,3243,3222,3200,3179,3157,3136,3114,3092,3069,3047,
3024,3002,2979,2956,2933,2909,2886,2862,2838,2815,2791,2767,2742,2718,
2694,2669,2645,2620,2595,2570,2545,2520,2495,2470,2445,2419,2394,2368,
2343,2317,2292,2266,2241,2215,2189,2163,2138,2112,2086,2060,2035,2009,
1983,1957,1932,1906,1880,1854,1829,1803,1778,1752,1727,1701,1676,1650,
1625,1600,1575,1550,1525,1500,1475,1450,1426,1401,1377,1353,1328,1304,
1280,1257,1233,1209,1186,1162,1139,1116,1093,1071,1048,1026,1003,981,
959,938,916,895,873,852,832,811,790,770,750,730,711,691,672,653,634,
616,597,579,561,544,526,509,492,476,459,443,427,412,396,381,366,352,
337,323,310,296,283,270,257,245,233,221,210,198,187,177,167,156,147,
137,128,119,111,103,95,87,80,73,66,60,54,48,43,38,33,28,24,21,17,14,
11,9,6,4,3,2,1,0,0,0,0,1,2,4,5,7,10,12,15,19,22,26,31,35,40,45,51,
57,63,69,76,83,91,99,107,115,124,133,142,152,161,172,182,193,204,215,
227,239,251,264,276,290,303,317,330,345,359,374,389,404,420,435,451,
468,484,501,518,535,553,570,588,607,625,644,663,682,701,720,740,760,
780,801,821,842,863,884,905,927,948,970,992,1014,1037,1059,1082,1105,
1128,1151,1174,1197,1221,1245,1268,1292,1316,1340,1365,1389,1414,1438,
1463,1488,1512,1537,1562,1587,1613,1638,1663,1688,1714,1739,1765,1790,
1816,1842,1867,1893,1919,1944,1970,1996,2022,2047};


void setup() {
}


void loop() {
  // signal generation
  output_signal = sine_table[index];
  index++;
  if(index == 500) index = 0;

  // output to DAC
  dac.writeValue(output_signal);
}